<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GIF Battle - Join</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <div class="join-screen">
            <h1>ğŸ¬ GIF Battle</h1>
            <p class="subtitle">Find the perfect GIF to win the crowd!</p>
            
            <div class="join-form">
                <div class="form-group">
                    <label for="player-name">Your Name</label>
                    <input type="text" id="player-name" placeholder="Enter your name" maxlength="20" required>
                </div>
                
                <div class="form-group">
                    <label>Choose Your Emoji</label>
                    <div class="emoji-grid" id="emoji-grid">
                        <button class="emoji-btn" data-emoji="ğŸ˜€">ğŸ˜€</button>
                        <button class="emoji-btn" data-emoji="ğŸ˜ƒ">ğŸ˜ƒ</button>
                        <button class="emoji-btn" data-emoji="ğŸ˜„">ğŸ˜„</button>
                        <button class="emoji-btn" data-emoji="ğŸ˜">ğŸ˜</button>
                        <button class="emoji-btn" data-emoji="ğŸ˜†">ğŸ˜†</button>
                        <button class="emoji-btn" data-emoji="ğŸ˜">ğŸ˜</button>
                        <button class="emoji-btn" data-emoji="ğŸ¤©">ğŸ¤©</button>
                        <button class="emoji-btn" data-emoji="ğŸ¥³">ğŸ¥³</button>
                        <button class="emoji-btn" data-emoji="ğŸ˜‡">ğŸ˜‡</button>
                        <button class="emoji-btn" data-emoji="ğŸ¤“">ğŸ¤“</button>
                        <button class="emoji-btn" data-emoji="ğŸ¤ ">ğŸ¤ </button>
                        <button class="emoji-btn" data-emoji="ğŸ¥¸">ğŸ¥¸</button>
                        <button class="emoji-btn" data-emoji="ğŸ¤¡">ğŸ¤¡</button>
                        <button class="emoji-btn" data-emoji="ğŸ¤–">ğŸ¤–</button>
                        <button class="emoji-btn" data-emoji="ğŸ‘»">ğŸ‘»</button>
                        <button class="emoji-btn" data-emoji="ğŸ‘½">ğŸ‘½</button>
                        <button class="emoji-btn" data-emoji="ğŸƒ">ğŸƒ</button>
                        <button class="emoji-btn" data-emoji="ğŸ’€">ğŸ’€</button>
                        <button class="emoji-btn" data-emoji="ğŸ¶">ğŸ¶</button>
                        <button class="emoji-btn" data-emoji="ğŸ±">ğŸ±</button>
                        <button class="emoji-btn" data-emoji="ğŸ­">ğŸ­</button>
                        <button class="emoji-btn" data-emoji="ğŸ¹">ğŸ¹</button>
                        <button class="emoji-btn" data-emoji="ğŸ°">ğŸ°</button>
                        <button class="emoji-btn" data-emoji="ğŸ¦Š">ğŸ¦Š</button>
                        <button class="emoji-btn" data-emoji="ğŸ»">ğŸ»</button>
                        <button class="emoji-btn" data-emoji="ğŸ¼">ğŸ¼</button>
                        <button class="emoji-btn" data-emoji="ğŸ¨">ğŸ¨</button>
                        <button class="emoji-btn" data-emoji="ğŸ¯">ğŸ¯</button>
                        <button class="emoji-btn" data-emoji="ğŸ¦">ğŸ¦</button>
                        <button class="emoji-btn" data-emoji="ğŸ®">ğŸ®</button>
                        <button class="emoji-btn" data-emoji="ğŸ·">ğŸ·</button>
                        <button class="emoji-btn" data-emoji="ğŸ¸">ğŸ¸</button>
                        <button class="emoji-btn" data-emoji="ğŸµ">ğŸµ</button>
                        <button class="emoji-btn" data-emoji="ğŸ™ˆ">ğŸ™ˆ</button>
                        <button class="emoji-btn" data-emoji="ğŸ™‰">ğŸ™‰</button>
                        <button class="emoji-btn" data-emoji="ğŸ™Š">ğŸ™Š</button>
                        <button class="emoji-btn" data-emoji="ğŸ”">ğŸ”</button>
                        <button class="emoji-btn" data-emoji="ğŸ§">ğŸ§</button>
                        <button class="emoji-btn" data-emoji="ğŸ¦">ğŸ¦</button>
                        <button class="emoji-btn" data-emoji="ğŸ¦„">ğŸ¦„</button>
                        <button class="emoji-btn" data-emoji="ğŸ">ğŸ</button>
                        <button class="emoji-btn" data-emoji="ğŸ¦‹">ğŸ¦‹</button>
                        <button class="emoji-btn" data-emoji="ğŸ™">ğŸ™</button>
                        <button class="emoji-btn" data-emoji="ğŸ¦€">ğŸ¦€</button>
                        <button class="emoji-btn" data-emoji="ğŸ¦–">ğŸ¦–</button>
                        <button class="emoji-btn" data-emoji="ğŸ¦•">ğŸ¦•</button>
                        <button class="emoji-btn" data-emoji="ğŸŒŸ">ğŸŒŸ</button>
                        <button class="emoji-btn" data-emoji="â­">â­</button>
                        <button class="emoji-btn" data-emoji="âœ¨">âœ¨</button>
                        <button class="emoji-btn" data-emoji="ğŸ’«">ğŸ’«</button>
                        <button class="emoji-btn" data-emoji="ğŸ”¥">ğŸ”¥</button>
                        <button class="emoji-btn" data-emoji="ğŸ’§">ğŸ’§</button>
                        <button class="emoji-btn" data-emoji="âš¡">âš¡</button>
                        <button class="emoji-btn" data-emoji="ğŸŒˆ">ğŸŒˆ</button>
                        <button class="emoji-btn" data-emoji="ğŸ•">ğŸ•</button>
                        <button class="emoji-btn" data-emoji="ğŸ”">ğŸ”</button>
                        <button class="emoji-btn" data-emoji="ğŸ©">ğŸ©</button>
                        <button class="emoji-btn" data-emoji="ğŸª">ğŸª</button>
                        <button class="emoji-btn" data-emoji="ğŸ®">ğŸ®</button>
                        <button class="emoji-btn" data-emoji="ğŸ¯">ğŸ¯</button>
                        <button class="emoji-btn" data-emoji="ğŸ¨">ğŸ¨</button>
                        <button class="emoji-btn" data-emoji="ğŸ¬">ğŸ¬</button>
                        <button class="emoji-btn" data-emoji="ğŸª">ğŸª</button>
                        <button class="emoji-btn" data-emoji="ğŸš€">ğŸš€</button>
                        <button class="emoji-btn" data-emoji="ğŸ›¸">ğŸ›¸</button>
                        <button class="emoji-btn" data-emoji="ğŸ†">ğŸ†</button>
                        <button class="emoji-btn" data-emoji="ğŸ¥‡">ğŸ¥‡</button>
                        <button class="emoji-btn" data-emoji="ğŸ’">ğŸ’</button>
                        <button class="emoji-btn" data-emoji="ğŸ‘‘">ğŸ‘‘</button>
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="checkbox-label">
                        <input type="checkbox" id="is-gm">
                        <span>I want to be the Game Master</span>
                    </label>
                    <p class="help-text">The Game Master creates prompts for each round</p>
                </div>
                
                <button class="btn-primary" id="join-btn" disabled>Join Game</button>
            </div>
        </div>
    </div>
    
    <script src="/socket.io/socket.io.js"></script>
    <script>
        let selectedEmoji = null;
        const socket = io();
        
        // Listen for GM status updates
        socket.on('gm:status', (data) => {
            const gmCheckbox = document.getElementById('is-gm');
            const gmLabel = document.querySelector('.checkbox-label');
            if (data.hasGM) {
                gmCheckbox.disabled = true;
                gmCheckbox.checked = false;
                gmLabel.style.opacity = '0.5';
                gmLabel.style.cursor = 'not-allowed';
                document.querySelector('.help-text').textContent = 'Game Master position is already taken';
            } else {
                gmCheckbox.disabled = false;
                gmLabel.style.opacity = '1';
                gmLabel.style.cursor = 'pointer';
                document.querySelector('.help-text').textContent = 'The Game Master creates prompts for each round';
            }
        });
        
        // Request current GM status on load
        socket.emit('gm:check');
        
        // Emoji selection
        document.querySelectorAll('.emoji-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                document.querySelectorAll('.emoji-btn').forEach(b => b.classList.remove('selected'));
                btn.classList.add('selected');
                selectedEmoji = btn.dataset.emoji;
                checkFormValid();
            });
        });
        
        // Name input
        document.getElementById('player-name').addEventListener('input', checkFormValid);
        
        function checkFormValid() {
            const name = document.getElementById('player-name').value.trim();
            const joinBtn = document.getElementById('join-btn');
            joinBtn.disabled = !(name && selectedEmoji);
        }
        
        // Join game
        document.getElementById('join-btn').addEventListener('click', () => {
            const name = document.getElementById('player-name').value.trim();
            const isGM = document.getElementById('is-gm').checked;
            
            if (name && selectedEmoji) {
                // Store in sessionStorage
                sessionStorage.setItem('playerName', name);
                sessionStorage.setItem('playerEmoji', selectedEmoji);
                sessionStorage.setItem('isGM', isGM);
                
                // Redirect to game
                window.location.href = '/game.html';
            }
        });
    </script>
</body>
</html>
